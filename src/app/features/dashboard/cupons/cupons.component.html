<div class="coupons-page">
  <app-status-alert></app-status-alert>
  
  <app-deactivate-coupon-modal
    [isOpen]="showDeactivateModal"
    (closeModal)="closeDeactivateModal()"
    (confirmDeactivation)="confirmDeactivation()"
  ></app-deactivate-coupon-modal>

  <!-- Header -->
  <header class="page-header">
    <h1>Meus cupons</h1>
    <p>Defina os cupons que você irá ofertar no app.</p>
  </header>

  <!-- Fixed Coupon Section -->
  <section class="fixed-coupon-section">
    <div class="fixed-coupon-card">
      <img [src]="fixedCoupon.image" [alt]="fixedCoupon.title" class="coupon-image" />
      <div class="coupon-content">
        <div class="coupon-header">
          <h3 class="coupon-title">{{ fixedCoupon.title }}</h3>
          <button class="icon-button info-button" type="button">
            <mat-icon>info</mat-icon>
          </button>
        </div>
        <p class="coupon-description">{{ fixedCoupon.description }}</p>
      </div>
      <div class="coupon-actions">
        <button class="icon-button" type="button" (click)="viewCoupon(fixedCoupon.id)">
          <mat-icon>visibility</mat-icon>
        </button>
        <button class="icon-button" type="button" (click)="editCoupon(fixedCoupon.id)">
          <mat-icon>edit</mat-icon>
        </button>
      </div>
    </div>
  </section>

  <!-- Other Offers Section -->
  <section class="other-offers-section">
    <h2 class="section-title">Outras ofertas</h2>
    <p class="section-subtitle">
      Caso deseje, você pode ofertar outros cupons para os clientes do app.
    </p>

    <!-- Search and Filters -->
    <div class="filters-bar">
      <div class="search-wrapper">
        <mat-icon class="search-icon">search</mat-icon>
        <input
          type="text"
          class="search-input"
          placeholder="Pesquisar"
          [(ngModel)]="searchQuery"
        />
      </div>
      <button class="date-filter-button" type="button">
        <mat-icon>calendar_today</mat-icon>
        <span>Data</span>
      </button>
      <button class="new-coupon-button" type="button" routerLink="/cupons/criar">
        <span class="button-icon">+</span>
        Novo cupom
      </button>
    </div>

    <!-- Tabs -->
    <div class="tabs-wrapper">
      <button
        class="tab"
        [class.active]="activeTab === 'Ativas'"
        (click)="setActiveTab('Ativas')"
        type="button"
      >
        Ativas
      </button>
      <button
        class="tab"
        [class.active]="activeTab === 'Finalizadas'"
        (click)="setActiveTab('Finalizadas')"
        type="button"
      >
        Finalizadas
      </button>
      <button
        class="tab"
        [class.active]="activeTab === 'Reprovadas'"
        (click)="setActiveTab('Reprovadas')"
        type="button"
      >
        Reprovadas
      </button>
      <button
        class="tab"
        [class.active]="activeTab === 'Em análise'"
        (click)="setActiveTab('Em análise')"
        type="button"
      >
        Em análise
      </button>
    </div>

    <!-- Coupon List -->
    <div class="coupons-list">
      <div *ngFor="let coupon of filteredCoupons" class="coupon-card">
        <img [src]="coupon.image" [alt]="coupon.title" class="coupon-image" />
        <div class="coupon-details">
          <div class="status-badge">
            <span class="status-dot"></span>
            <span class="status-text">{{ coupon.status }}</span>
          </div>
          <h3 class="coupon-title-main">{{ coupon.title }}</h3>
          <div class="coupon-date">
            <mat-icon>calendar_today</mat-icon>
            <span>{{ coupon.startDate }} - {{ coupon.endDate }}</span>
          </div>
        </div>
        <div class="coupon-usage">
          <div class="usage-bar">
            <div class="usage-fill" [style.width.%]="getUsagePercentage(coupon)"></div>
          </div>
          <span class="usage-text">{{ coupon.usedToday }}/{{ coupon.totalDaily }} cupons utilizados hoje</span>
        </div>
        <div class="coupon-actions-list">
          <button class="icon-button" type="button" (click)="viewCoupon(coupon.id)">
            <mat-icon>visibility</mat-icon>
          </button>
          <button class="icon-button" type="button" (click)="editCoupon(coupon.id)">
            <mat-icon>edit</mat-icon>
          </button>
          <button class="icon-button delete-button" type="button" (click)="deleteCoupon(coupon.id)">
            <mat-icon>close</mat-icon>
          </button>
        </div>
      </div>
    </div>

    <!-- Pagination -->
    <div class="pagination">
      <span class="pagination-text">Página 1 de 10</span>
      <div class="pagination-buttons">
        <button class="pagination-button" type="button">
          <mat-icon>chevron_left</mat-icon>
        </button>
        <button class="pagination-button" type="button">
          <mat-icon>chevron_right</mat-icon>
        </button>
        <button class="pagination-button" type="button">
          <mat-icon>last_page</mat-icon>
        </button>
      </div>
    </div>
  </section>
</div>

<app-deactivate-coupon-modal
  [(visible)]="showDeactivateModal"
  (modalClose)="onModalClose()"
></app-deactivate-coupon-modal>
